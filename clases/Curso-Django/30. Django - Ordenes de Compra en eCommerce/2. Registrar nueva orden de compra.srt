1
00:00:00,390 --> 00:00:07,620
En este capítulo vamos a crear los pads de las URLs para esta nueva funcionalidad de órdenes de compras.

2
00:00:08,430 --> 00:00:15,900
Vamos entonces hacia la carpeta de e-commerce dentro del ecommerce que aparece y vamos al archivo URLs

3
00:00:16,390 --> 00:00:18,240
y lo hemos abierto.

4
00:00:18,810 --> 00:00:22,920
Aquí está la lista de Paths de todas las apps que tenemos dentro de este proyecto.

5
00:00:23,100 --> 00:00:25,710
Vamos a agregar el path para órdenes.

6
00:00:26,750 --> 00:00:29,480
Voy a copiar este path que existe sobre account.

7
00:00:31,670 --> 00:00:34,520
Te lo pego y vamos a colocarle en vez de account.

8
00:00:36,580 --> 00:00:39,600
Orders slash included.

9
00:00:39,670 --> 00:00:40,650
A quién va a incluir?

10
00:00:40,660 --> 00:00:43,270
Al archivo que se va a llamar?

11
00:00:44,530 --> 00:00:46,540
Orders calls.

12
00:00:49,850 --> 00:00:55,370
Ahora vamos al archivo que representa la app de Orders Orders y vamos a crear el archivo.

13
00:00:55,370 --> 00:00:57,530
Yo era el API que aún no existe.

14
00:00:58,070 --> 00:01:03,340
Vamos a ir a la carpeta Orders News File que aparece Orders para que Slash.

15
00:01:03,530 --> 00:01:07,850
Yo le escribo Jureles Happy y le voy a entrar.

16
00:01:09,720 --> 00:01:11,160
De aquí, vamos a agregar.

17
00:01:12,860 --> 00:01:13,420
Los pads.

18
00:01:13,440 --> 00:01:15,960
Pero primero vamos a agregar las referencias.

19
00:01:16,140 --> 00:01:19,590
Necesito el rango models import.

20
00:01:20,600 --> 00:01:24,410
Este Pat también voy a importar.

21
00:01:25,830 --> 00:01:27,930
Lo que son las funciones del archivo.

22
00:01:28,710 --> 00:01:37,530
Ahora, si vamos a crear esta variable y entre corchetes creamos el path aquí, a este path le vamos

23
00:01:37,530 --> 00:01:41,000
a poner primeramente placeholder place order.

24
00:01:41,310 --> 00:01:42,390
Ordenar la orden.

25
00:01:44,160 --> 00:01:45,330
Coma dos.

26
00:01:47,010 --> 00:01:50,100
Place Order es el nombre de la función.

27
00:01:51,990 --> 00:01:57,270
Entre apóstrofes Place Order y coma, al final siempre muy importante.

28
00:01:57,540 --> 00:02:01,930
A continuación vamos a crear la función de placeholder, que es la generación.

29
00:02:01,950 --> 00:02:04,530
Esta función se va a encargar de crear la orden de compra.

30
00:02:04,830 --> 00:02:10,230
Entonces vamos hacia el archivo PID que se encuentra al interior de la carpeta orders.

31
00:02:10,800 --> 00:02:15,300
Lo abrimos y vamos a primero importar las librerías que necesito.

32
00:02:16,110 --> 00:02:24,030
Primero voy a hacer que importe el modelo de Cards Models y aquí le indico que me traiga a la entidad

33
00:02:24,030 --> 00:02:24,750
Card Item.

34
00:02:25,890 --> 00:02:31,320
También voy a necesitar crear un objeto de tipo formulario, un orden form.

35
00:02:31,560 --> 00:02:37,260
Recuerda que nosotros tenemos que capturar esta data, esta data, este formulario.

36
00:02:37,740 --> 00:02:42,930
Una vez que el usuario ingrese la data y yo le de clic a los productos, se va a disparar esta función

37
00:02:42,930 --> 00:02:45,090
placeholder que estoy trabajando en ese momento.

38
00:02:45,330 --> 00:02:51,690
Y se supone que esa función va a tener que capturar estos datos del formulario y crear la orden.

39
00:02:52,550 --> 00:02:57,860
Pero para esto voy a tener que crear a futuro un objeto nuevo componente de tipo Jango Form.

40
00:02:59,030 --> 00:03:00,700
Por ahora vamos a crearlo en blanco.

41
00:03:00,710 --> 00:03:07,580
Dale click derecho a orders y la opción New File que aparece orders para que slash y le vas a poner

42
00:03:07,580 --> 00:03:08,120
forms.

43
00:03:08,840 --> 00:03:09,860
Punto y.

44
00:03:10,930 --> 00:03:12,310
Y le damos enter.

45
00:03:13,480 --> 00:03:14,170
No te preocupes.

46
00:03:14,170 --> 00:03:16,600
Por ahora dejalo en blanco y luego vamos a continuar trabajando aquí.

47
00:03:16,870 --> 00:03:20,200
Volvamos al archivo de la carpeta orders.

48
00:03:21,320 --> 00:03:22,600
Y voy a importar.

49
00:03:22,610 --> 00:03:24,380
Voy a referenciar a este archivo.

50
00:03:25,930 --> 00:03:27,340
Así que le ponemos from.

51
00:03:28,650 --> 00:03:35,010
Punto form forms con ese import al orden form que luego vamos a crear.

52
00:03:35,010 --> 00:03:35,910
Por ahora déjalo así.

53
00:03:36,420 --> 00:03:36,890
Y ahora.

54
00:03:36,930 --> 00:03:40,830
Aquí definimos la función que se llama Plays Order.

55
00:03:42,470 --> 00:03:45,500
Y para recibir un objeto rico es dos puntos.

56
00:03:46,830 --> 00:03:52,320
Vamos a comenzar por capturar los los items del carrito de compras.

57
00:03:52,320 --> 00:03:53,940
Las líneas del carrito de compras.

58
00:03:53,940 --> 00:03:59,910
Por eso hacemos un car items igual a car item punto objects.

59
00:04:01,230 --> 00:04:02,250
Punto filter.

60
00:04:03,120 --> 00:04:08,100
Capturó todos los elementos del carrito de compras que estén registrados con el usuario que está en

61
00:04:08,100 --> 00:04:08,610
sesión.

62
00:04:09,060 --> 00:04:11,910
Por eso es que le voy a poner un user igual a current.

63
00:04:12,900 --> 00:04:13,500
Yo ser.

64
00:04:14,660 --> 00:04:15,570
Está reunido.

65
00:04:15,770 --> 00:04:16,390
Aún no existe.

66
00:04:16,400 --> 00:04:17,780
La voy a crear en la parte superior.

67
00:04:17,780 --> 00:04:20,210
Aquí voy a poner Current User.

68
00:04:20,570 --> 00:04:22,460
Es igual a user.

69
00:04:23,510 --> 00:04:27,890
Es muy similar al código que hemos estado trabajando antes, por eso lo estoy haciendo un poco más rápido.

70
00:04:29,330 --> 00:04:32,660
También quiero saber la cantidad de elementos que tiene el carrito de compras actualmente.

71
00:04:33,730 --> 00:04:40,150
Por eso voy a poner una cantidad de elementos igual a que items, trabajo, items.

72
00:04:40,540 --> 00:04:41,260
Punto.

73
00:04:41,260 --> 00:04:42,550
Su función count.

74
00:04:44,780 --> 00:04:45,800
Y una condición.

75
00:04:45,810 --> 00:04:46,370
Si.

76
00:04:48,420 --> 00:04:52,140
Card count es menor o igual que cero.

77
00:04:53,820 --> 00:05:00,390
Entonces le voy a indicar que directamente me haga un redirección a la página de Store return redirección.

78
00:05:01,730 --> 00:05:04,750
A la página de autor porque no tengo ningún elemento que comprar en este momento.

79
00:05:04,760 --> 00:05:10,610
Entonces quiero que el cliente vaya otra vez a la página Store y seleccione el producto que realmente

80
00:05:10,610 --> 00:05:11,270
va a comprar.

81
00:05:12,650 --> 00:05:15,740
También voy a aprovechar aquí para inicializar estas variables.

82
00:05:15,740 --> 00:05:16,610
El gran total.

83
00:05:17,470 --> 00:05:20,740
Que representa el total final a pagar, incluyendo el impuesto.

84
00:05:21,790 --> 00:05:22,870
El precio del tax.

85
00:05:22,900 --> 00:05:25,210
El impuesto que voy a inicializar en cero.

86
00:05:26,020 --> 00:05:26,560
Y ahora.

87
00:05:27,900 --> 00:05:34,080
Voy a hacer un bucle para leer todos los elementos del carrito de compras que quiero agregar dentro

88
00:05:34,080 --> 00:05:35,400
de la orden de compra.

89
00:05:36,160 --> 00:05:39,990
Entonces aquí le pongo Car item im card items.

90
00:05:41,580 --> 00:05:44,640
Recuerda que ese ítem lo estoy obteniendo en esta línea.

91
00:05:46,610 --> 00:05:49,190
Le ponemos dos puntos y leemos los datos.

92
00:05:49,220 --> 00:05:52,640
Voy a acumular los valores dentro de esta variable total.

93
00:05:52,650 --> 00:05:53,390
Es un acumulador.

94
00:05:53,400 --> 00:05:55,590
Este total total va a ser igual a quien?

95
00:05:57,870 --> 00:05:58,160
Acá.

96
00:05:58,290 --> 00:05:58,740
Ítem.

97
00:06:00,560 --> 00:06:01,730
Punto product.

98
00:06:02,930 --> 00:06:05,300
Y esto multiplicado por car item.

99
00:06:07,630 --> 00:06:08,150
Punto.

100
00:06:08,200 --> 00:06:10,480
Cuando estoy acá, estoy aquí.

101
00:06:11,460 --> 00:06:14,880
Multiplicando el precio del producto por la cantidad de productos.

102
00:06:14,880 --> 00:06:17,510
Eso me va a dar un total que voy a ir acumulando bien.

103
00:06:17,580 --> 00:06:20,760
Pero aquí me faltó agregarle lo del producto, el punto Price.

104
00:06:21,060 --> 00:06:22,110
El precio del producto.

105
00:06:22,650 --> 00:06:23,820
Precio por la cantidad.

106
00:06:24,780 --> 00:06:30,630
También quiero saber cuántas cuantos elementos de producto existen, así que voy a acumular la cantidad

107
00:06:30,630 --> 00:06:31,290
de productos.

108
00:06:32,600 --> 00:06:36,370
Le voy a poner car item quality.

109
00:06:38,230 --> 00:06:38,680
Listo.

110
00:06:39,760 --> 00:06:40,870
Eso es parte del bucle.

111
00:06:41,320 --> 00:06:44,680
Ahora voy a saber cuanto es el impuesto que debo pagar.

112
00:06:44,830 --> 00:06:47,140
Para esto utilizo esta fórmula.

113
00:06:47,650 --> 00:06:52,600
Le voy a indicar que sea el 2% para que sea el 2% del total.

114
00:06:52,750 --> 00:06:55,960
Voy a multiplicar dos por total.

115
00:06:58,430 --> 00:06:59,900
Dividido entre 100.

116
00:07:00,770 --> 00:07:01,060
Ese es.

117
00:07:01,250 --> 00:07:02,000
Ese es el impuesto.

118
00:07:02,000 --> 00:07:02,990
Entonces que voy a pagar?

119
00:07:03,440 --> 00:07:04,330
Estoy asumiéndolo.

120
00:07:04,370 --> 00:07:08,210
Esto va a depender, en otras palabras, del país donde te encuentres.

121
00:07:08,240 --> 00:07:10,700
Cada país tiene sus propias tasas de impuestos.

122
00:07:12,010 --> 00:07:19,330
Y ahora el total a pagar, incluyendo el impuesto, sería igual a que al total inicial, sumando con

123
00:07:19,330 --> 00:07:20,410
impuestos que es el tax.

124
00:07:21,690 --> 00:07:22,050
Listo.

125
00:07:22,390 --> 00:07:28,230
Entonces ya saqué los datos genéricos, los datos tipo cabecera del carrito de compras que se va a agregar

126
00:07:28,230 --> 00:07:34,680
dentro de la orden de compra, que incluye los precios de los productos que el cliente va a comprar

127
00:07:34,680 --> 00:07:36,610
y que provienen desde el carrito de compras.

128
00:07:36,630 --> 00:07:39,690
Ahora, esos datos ya le pertenecen a la orden de compra.

129
00:07:39,870 --> 00:07:41,130
Pero esto no es suficiente.

130
00:07:41,340 --> 00:07:47,250
También quiero agregar a la orden de compra los datos del cliente como el nombre, el apellido, el

131
00:07:47,250 --> 00:07:49,410
email, el teléfono, dirección, etcétera.

132
00:07:50,590 --> 00:07:53,910
Para poder capturar estos datos tengo que llamar al método Post.

133
00:07:53,920 --> 00:07:58,660
Se van a enviar por el formulario utilizando el rango Form component.

134
00:07:59,440 --> 00:08:05,320
Así que continuando dentro del método placeholder, voy a primero hacer una validación indico si el

135
00:08:05,320 --> 00:08:10,360
método de request para capturar los datos es igual a un método tipo post.

136
00:08:12,820 --> 00:08:18,220
Si esto es verdad, entonces quiero que instancias al objeto orden form.

137
00:08:19,750 --> 00:08:25,180
Este objeto order form aún no lo he creado, pero se va a encontrar dentro del archivo que estoy importando,

138
00:08:25,180 --> 00:08:29,620
que es el archivo Forms y que está en la carpeta orders.

139
00:08:31,520 --> 00:08:34,520
Y lo inicializa con el request post.

140
00:08:35,570 --> 00:08:42,680
Visto de esta forma, enlazo los atributos que voy a definir dentro del orden form con los atributos

141
00:08:42,680 --> 00:08:46,850
que vienen que están dentro del formulario HTML de mi template.

142
00:08:48,940 --> 00:08:50,110
Y ahora voy a validar.

143
00:08:50,120 --> 00:08:54,490
Digo, si todo es correcto en el formulario de Jango, entonces voy a colocar aquí un form.

144
00:08:55,330 --> 00:08:56,080
Is valid.

145
00:08:56,620 --> 00:08:57,400
Esto es válido.

146
00:08:57,820 --> 00:08:59,800
Entonces haz lo siguiente.

147
00:08:59,800 --> 00:09:01,330
Comencemos a capturar la data.

148
00:09:01,930 --> 00:09:05,260
Voy a colocarle que una instancia data es igual a Order.

149
00:09:06,470 --> 00:09:07,460
Una instancia de orden.

150
00:09:09,480 --> 00:09:12,300
Y le voy a decir Data first name.

151
00:09:12,510 --> 00:09:16,260
Recuerda que orden la entidad Order es la orden de compra.

152
00:09:16,260 --> 00:09:22,440
Estoy creando en este momento una orden de compra y tengo que darle los valores que va a tener esta

153
00:09:22,440 --> 00:09:23,220
orden de compra.

154
00:09:23,550 --> 00:09:30,720
Data First Name va a venir de este form desde el juego Form utilizando el método Clean Data.

155
00:09:33,420 --> 00:09:35,460
Y este se llama First Name.

156
00:09:38,590 --> 00:09:41,270
También voy a capturar las name.

157
00:09:42,960 --> 00:09:43,710
El apellido.

158
00:09:46,560 --> 00:09:47,040
Por aquí.

159
00:09:47,730 --> 00:09:50,240
Aquí debe ser Last Name.

160
00:09:50,810 --> 00:09:51,030
Esto.

161
00:09:52,670 --> 00:09:54,200
Vamos a capturar también el iPhone.

162
00:09:54,230 --> 00:10:00,640
El número de teléfono que está en el formulario HTML enlazado al Jango, ya que le ponemos zoom.

163
00:10:03,470 --> 00:10:04,520
También el email.

164
00:10:11,780 --> 00:10:12,830
Te ponemos el email.

165
00:10:14,790 --> 00:10:17,160
También vamos a colocarle el Address.

166
00:10:17,160 --> 00:10:17,850
La dirección.

167
00:10:18,090 --> 00:10:20,870
Recuerda que tiene dos partes address language.

168
00:10:25,440 --> 00:10:26,010
Padres.

169
00:10:27,580 --> 00:10:28,040
La lengua.

170
00:10:29,020 --> 00:10:29,390
Esto.

171
00:10:30,630 --> 00:10:33,630
Ah, mira que me faltó una S, doble S tres.

172
00:10:35,000 --> 00:10:38,680
Pero al copiar esta línea y ponemos el Address listo.

173
00:10:41,280 --> 00:10:41,550
Línea.

174
00:10:41,550 --> 00:10:42,420
Detalle dos.

175
00:10:44,520 --> 00:10:45,390
Continuamos.

176
00:10:45,420 --> 00:10:47,070
Ahora me falta el país.

177
00:10:47,660 --> 00:10:48,830
Voy a poner aquí country.

178
00:10:49,230 --> 00:10:49,830
País?

179
00:10:52,820 --> 00:10:54,260
Punto country.

180
00:10:56,680 --> 00:10:59,020
También vamos a agregar el State.

181
00:10:59,110 --> 00:11:02,230
La ciudad del distrito representa el departamento.

182
00:11:03,010 --> 00:11:08,290
Departamento o también, en algunos casos región, dependiendo del país donde te encuentres.

183
00:11:09,540 --> 00:11:11,760
Ahora la ciudad City.

184
00:11:19,770 --> 00:11:22,470
Y ahora el detalle de la nota de la orden de compra.

185
00:11:22,490 --> 00:11:22,890
Yo lo vi.

186
00:11:22,960 --> 00:11:24,360
Yo le había puesto ese campo.

187
00:11:24,360 --> 00:11:25,170
Order not.

188
00:11:27,260 --> 00:11:28,470
Está ordenó.

189
00:11:32,300 --> 00:11:39,500
Hay que tener mucho cuidado entre la definición del atributo dentro de order versus la definición del

190
00:11:39,500 --> 00:11:42,830
formulario que vas a hacer dentro del rango form.

191
00:11:43,700 --> 00:11:45,410
Posteriormente vamos a definir eso.

192
00:11:46,310 --> 00:11:51,470
Entonces mira dentro de este order, la entidad order que está dentro del archivo Models.

193
00:11:51,800 --> 00:11:55,350
Yo le voy a definir address con Double s o con una DS.

194
00:11:55,370 --> 00:11:56,330
Vamos a revisarlo.

195
00:11:56,840 --> 00:11:58,580
Vamos a entrar hacia Form.

196
00:11:58,580 --> 00:12:00,230
Hacia Models y.

197
00:12:02,480 --> 00:12:06,800
Y acá en la sección del order, este es el order class order.

198
00:12:07,190 --> 00:12:10,010
Aquí está el address y las slides.

199
00:12:10,520 --> 00:12:12,620
Yo la había puesto con una sola S.

200
00:12:13,070 --> 00:12:14,210
Vamos a seguir este patrón.

201
00:12:14,660 --> 00:12:15,950
Vamos a ponerle solo una s.

202
00:12:16,220 --> 00:12:19,760
Posteriormente vamos a tratar de arreglarlo con otra Migration.

203
00:12:19,760 --> 00:12:23,870
Pero en este momento no quiero ejecutar ninguna migración porque estoy dentro de la transacción.

204
00:12:24,140 --> 00:12:24,800
No hay problema.

205
00:12:24,800 --> 00:12:27,020
Voy a ponerle sola una, solo una S.

206
00:12:27,440 --> 00:12:29,420
Volvemos entonces al punto P y.

207
00:12:30,610 --> 00:12:33,490
Y aquí le vamos a poner solo una S a ese tres.

208
00:12:34,610 --> 00:12:35,540
Esto lo tengo.

209
00:12:35,540 --> 00:12:40,850
El otro slide está con una s, el del slide está con una S también.

210
00:12:41,710 --> 00:12:45,830
Para el caso de este Address Language que viene desde el Falkland Data.

211
00:12:46,190 --> 00:12:50,080
Esto pertenece al Chango Forms y al HTML Form.

212
00:12:50,090 --> 00:12:52,400
Esto no tiene realmente mucha ciencia.

213
00:12:52,400 --> 00:12:54,650
Ese sí puede mantenerse con la doble S.

214
00:12:55,100 --> 00:12:56,980
Está bien de mucho cuidado acá.

215
00:12:56,990 --> 00:12:58,550
Este sí lo voy a meter con una doble C.

216
00:12:59,600 --> 00:13:06,230
Continuemos ahora, después del orden no me falta agregar la orden total, así que lo voy a poner acá,

217
00:13:06,230 --> 00:13:09,320
que data punto order total.

218
00:13:09,800 --> 00:13:15,500
El total va a ser igual a la variable total que he calculado en la parte superior.

219
00:13:16,420 --> 00:13:16,720
Aquí.

220
00:13:18,220 --> 00:13:22,270
Yaquí estoy sesteando dentro de este campo o del total de mi entidad.

221
00:13:22,270 --> 00:13:22,740
Order.

222
00:13:23,590 --> 00:13:23,970
Listo.

223
00:13:25,490 --> 00:13:27,330
También me pide el data tax.

224
00:13:27,440 --> 00:13:30,040
Igual este tax también ya lo he calculado.

225
00:13:30,050 --> 00:13:32,630
Es un campo calculado que se acaba aquí de mi lógica.

226
00:13:34,040 --> 00:13:34,570
Problema.

227
00:13:35,280 --> 00:13:39,300
Continuamos el data punto y el IP desde el cual se está haciendo?

228
00:13:39,320 --> 00:13:42,230
Se está generando la orden de compra para hacerlo?

229
00:13:42,860 --> 00:13:45,770
Realmente ese dato no está dentro de formularios HTML.

230
00:13:45,800 --> 00:13:48,470
Esto lo obtengo desde una función de Python.

231
00:13:49,620 --> 00:13:50,510
Del Chango Pitón.

232
00:13:50,520 --> 00:13:56,760
Entonces hacemos un meetup que esto no solamente va a tomar todos los datos del estatuto del objeto

233
00:13:56,760 --> 00:14:06,060
o de esta función que ordene el expediente y le va a generar el ID y un ID de los datos.

234
00:14:06,570 --> 00:14:12,570
Voy a llamar a la cámara ahí para que este recorte almacene el número de orden.

235
00:14:12,870 --> 00:14:17,340
Recuerda que tenemos un campo que se llama Order Number, pero yo no quiero eso.

236
00:14:17,350 --> 00:14:23,700
Yo quiero generar el número de orden, el orden number, utilizando otro nomenclatura, utilizando la

237
00:14:23,700 --> 00:14:27,360
fecha actual en la cual se está generando esta operación.

238
00:14:27,990 --> 00:14:35,250
Entonces, mira lo que voy a hacer, lo siguiente voy a indicarle primero una función para capturar

239
00:14:35,250 --> 00:14:36,060
el año actual.

240
00:14:36,690 --> 00:14:38,820
Entonces le digo Llamo al Int.

241
00:14:41,520 --> 00:14:45,960
Y le paso como parámetro el DateTime apunto to day la fecha actual.

242
00:14:48,350 --> 00:14:51,350
Y quiero que me retorne el año nada más.

243
00:14:51,350 --> 00:14:53,530
Por eso llamo str time.

244
00:14:54,840 --> 00:14:56,790
Y le indico que me devuelve el año.

245
00:14:57,860 --> 00:15:05,450
Entre un signo de porcentaje y mayúscula entre apóstrofes y ya me estoy devolviendo el año.

246
00:15:07,350 --> 00:15:09,510
Ahora quiero que me devuelva el.

247
00:15:10,410 --> 00:15:11,970
Vamos a perder acá el mes.

248
00:15:15,570 --> 00:15:16,580
Lo voy a poner el mes.

249
00:15:17,480 --> 00:15:20,810
Simplemente cambiaré la nomenclatura y le pongo el M.

250
00:15:21,790 --> 00:15:23,200
Quiero que me devuelva también el día.

251
00:15:23,920 --> 00:15:25,030
Entonces sería aquí.

252
00:15:26,170 --> 00:15:26,470
Te.

253
00:15:27,990 --> 00:15:29,040
Y le pongo el de.

254
00:15:31,460 --> 00:15:31,970
Listo.

255
00:15:33,020 --> 00:15:33,680
Ahora sí.

256
00:15:33,950 --> 00:15:37,120
Ya tengo entonces capturados el año actual.

257
00:15:37,130 --> 00:15:38,780
El mes actual y el día actual.

258
00:15:39,080 --> 00:15:40,550
Quiero agregar la fecha.

259
00:15:40,670 --> 00:15:45,410
Voy a poner aquí un di igual a tic tac, tic tac, tic, tac.

260
00:15:47,100 --> 00:15:49,080
Igual al anochecer.

261
00:15:51,160 --> 00:15:55,000
Mete el mes y también el DT el día.

262
00:15:57,820 --> 00:16:01,420
Y ahora quiero concatenar dos y agregar un nuevo formato a la fecha.

263
00:16:01,600 --> 00:16:05,710
Porque si yo imprimiera la fecha tal como está, me aparecería con un slash.

264
00:16:06,460 --> 00:16:07,240
Yo no quiero que aparezca.

265
00:16:07,560 --> 00:16:12,010
Yo quiero que me aparezcan los números, pero sin ningún carácter especial entre ellos.

266
00:16:12,430 --> 00:16:16,900
Entonces, para que ocurra esto, voy a indicarle Current Date igual a quien?

267
00:16:18,030 --> 00:16:23,610
Al de que representa la fecha punto str f time.

268
00:16:24,890 --> 00:16:27,530
Y le indico cuál es el formato en el cual quiero imprimir la fecha.

269
00:16:28,070 --> 00:16:29,240
Creo que imprime todo junto.

270
00:16:29,240 --> 00:16:37,190
Entonces aquí le voy a poner un momento aquí entre comillas, le voy a poner que sea un porcentaje y.

271
00:16:38,250 --> 00:16:39,840
Pegado al porcentaje.

272
00:16:41,000 --> 00:16:41,330
M.

273
00:16:42,950 --> 00:16:48,950
Pegado al porcentaje de lo que va a hacer esto es imprimir un valor.

274
00:16:49,830 --> 00:16:53,120
Suponiendo que es el año 2028 de esa forma.

275
00:16:53,130 --> 00:16:55,500
2028 el mes.

276
00:16:56,660 --> 00:16:57,140
Enero.

277
00:16:57,590 --> 00:16:58,580
El día 10.

278
00:16:59,210 --> 00:17:04,430
Entonces esta fecha en ese formato especial, representaría mi orden de compra.

279
00:17:04,730 --> 00:17:07,550
Mi número de orden de compra, mi orden number.

280
00:17:08,000 --> 00:17:12,590
Pero me puede decir profesor, pero eso pasaría siempre y cuando yo generara una orden de compra por

281
00:17:12,590 --> 00:17:12,830
día.

282
00:17:12,830 --> 00:17:19,160
Pero en mi página es altamente probable que pueda generar mil, 5000 órdenes de compra y la orden de

283
00:17:19,160 --> 00:17:21,650
compra no puede ser duplicada.

284
00:17:21,920 --> 00:17:22,280
Entonces.

285
00:17:22,280 --> 00:17:23,050
Qué debo hacer?

286
00:17:23,110 --> 00:17:27,830
Bueno, a esta orden de compra, deberías agregarle el ID que te generó.

287
00:17:28,980 --> 00:17:30,810
El proceso de orden de compra.

288
00:17:31,020 --> 00:17:36,870
Recuerda lo que te dije hace un rato cada vez que tu tú es un record dentro de orden, automáticamente

289
00:17:36,870 --> 00:17:38,760
se va a generar un ID único.

290
00:17:39,000 --> 00:17:40,410
Entonces se único.

291
00:17:40,410 --> 00:17:45,480
Lo vas a concatenar a este valor que representa a la fecha actual.

292
00:17:46,840 --> 00:17:52,420
Y esa concatenación representaría el número de orden de compra, el orden number.

293
00:17:52,630 --> 00:17:54,070
Cómo lo vamos a concatenar?

294
00:17:54,310 --> 00:17:55,360
A ver, aquí te lo enseño.

295
00:17:56,260 --> 00:17:59,350
Vamos a hacer un orders number.

296
00:18:01,510 --> 00:18:01,960
Igual.

297
00:18:01,960 --> 00:18:06,340
Acordate lo que tengo arriba concatenado con el.

298
00:18:06,880 --> 00:18:08,380
Vamos a poner acá str.

299
00:18:09,220 --> 00:18:13,440
Que lo convierte a String data void data.

300
00:18:13,450 --> 00:18:20,500
Recuerda que representa el record que estás ingresando a la base de datos y di el valor que está generando

301
00:18:20,500 --> 00:18:23,080
este proceso de guardar el record en la base de datos.

302
00:18:23,410 --> 00:18:26,260
Después del safe ya el data tiene un valor de EDI.

303
00:18:26,590 --> 00:18:31,810
Ese valor ready es el que quiero obtener acá, es el que quiero concatenar a la fecha actual.

304
00:18:32,960 --> 00:18:33,470
A esto.

305
00:18:35,320 --> 00:18:42,490
Una vez que ya tengo el orden number, entonces voy a llamar nuevamente a Data y a su campo, a su propiedad

306
00:18:42,490 --> 00:18:48,040
Orders Number, y le digo que el valor que se va a tener, cuál va a ser este order number?

307
00:18:48,980 --> 00:18:49,430
Listo.

308
00:18:50,350 --> 00:18:56,740
Y finalmente ha contactado para que actualice ese dato y ya tengo aquí el orden number.

309
00:18:56,740 --> 00:18:57,250
Listo.

310
00:18:57,790 --> 00:19:00,720
Finalmente tengo que hacer un return directo.

311
00:19:02,040 --> 00:19:02,770
Hacia dónde?

312
00:19:02,850 --> 00:19:04,320
Hacia la página de checkout.

313
00:19:06,250 --> 00:19:10,930
Bien, pero esto va a suceder siempre y cuando el formulario sea válido.

314
00:19:12,020 --> 00:19:14,660
Y también que esté dentro del método Post.

315
00:19:15,760 --> 00:19:20,620
Entonces a este nivel del if del request method post, voy a hacer un ALS.

316
00:19:21,340 --> 00:19:23,110
Tienes que tener mucho cuidado siempre con los Tabs.

317
00:19:23,800 --> 00:19:24,370
Ahí está.

318
00:19:24,940 --> 00:19:25,780
Le pongo un else.

319
00:19:25,840 --> 00:19:26,650
Dos puntos.

320
00:19:27,960 --> 00:19:32,550
Y le digo que me haga un return directo hacia también check out.

321
00:19:36,100 --> 00:19:41,850
A que me faltó agregar unas importaciones en la parte superior porque estoy utilizando este DateTime

322
00:19:41,850 --> 00:19:45,450
Function y también estoy utilizando a la entidad order.

323
00:19:45,870 --> 00:19:51,270
Así que vamos a la parte superior y después de este order form voy a agregar un from.

324
00:19:52,610 --> 00:19:54,170
El punto Models.

325
00:19:55,310 --> 00:19:56,030
Import.

326
00:19:56,960 --> 00:19:58,940
A order order.

327
00:19:59,870 --> 00:20:01,430
Y también voy a importar.

328
00:20:02,930 --> 00:20:03,710
Al DateTime.

329
00:20:05,460 --> 00:20:11,790
También aquí tengo que agregar dos parámetros muy importantes que necesita mi función, que son el total

330
00:20:12,060 --> 00:20:13,080
y el quality.

331
00:20:13,590 --> 00:20:19,740
Entonces aquí dentro de la función order, luego de request le pongo una coma y le pongo que el total

332
00:20:19,770 --> 00:20:27,210
se inicializa en cero y el uno acaba en cero igual a cero.

333
00:20:28,170 --> 00:20:28,620
Un momento.

334
00:20:28,620 --> 00:20:29,400
Voy a poner aquí.

335
00:20:29,400 --> 00:20:31,380
El total será igual.

336
00:20:32,620 --> 00:20:38,350
Claro, también en la parte superior me faltó agregar luego del render coma el retiré, porque estoy

337
00:20:38,620 --> 00:20:44,740
indicándole que una vez que termine la transacción me lleve hacia la página de checkout dentro del método.

338
00:20:45,100 --> 00:20:50,320
Aquí, dentro de las propiedades que estoy sorteando, me faltó agregar algo.

339
00:20:50,320 --> 00:20:55,210
Mira, el Data Order también necesita saber cuál es el usuario que está registrando este récord.

340
00:20:55,510 --> 00:20:59,980
Por eso voy a poner data user igual a current user.

341
00:21:00,550 --> 00:21:01,030
Listo.

342
00:21:01,750 --> 00:21:04,150
También aquí tengo un pequeño detalle.

343
00:21:04,420 --> 00:21:05,830
Yo lo estoy colocando aquí.

344
00:21:06,190 --> 00:21:08,620
Este estos valores entre paréntesis.

345
00:21:09,280 --> 00:21:11,530
El data debería ser entre corchetes.

346
00:21:12,870 --> 00:21:14,280
Entre corchetes aquí.

347
00:21:14,430 --> 00:21:15,960
Cometió un pequeño error.

348
00:21:16,560 --> 00:21:18,300
Vamos a reemplazarlo rápidamente.

349
00:21:25,020 --> 00:21:27,690
Esto de aquí le ponemos el corchete.

350
00:21:41,360 --> 00:21:43,250
Que faltó para las nueve.

351
00:21:44,270 --> 00:21:44,750
Ya lo tengo.

352
00:21:44,750 --> 00:21:45,230
Listo.

353
00:21:45,380 --> 00:21:48,250
Ahora lo que tenemos que hacer es crear los campos.

354
00:21:48,260 --> 00:21:50,020
La lógica para el orden Form.

355
00:21:50,020 --> 00:21:51,590
Recuerdas el Chango Form?

356
00:21:52,820 --> 00:21:55,700
Vamos a ir hacia Orders y al Archivo Fonseca.

357
00:21:56,150 --> 00:22:01,500
Y aquí voy a comenzar por hacer la importación de From Jango punto Front.

358
00:22:01,500 --> 00:22:02,390
Jango import.

359
00:22:04,180 --> 00:22:04,810
Forms.

360
00:22:06,740 --> 00:22:07,220
Tengo.

361
00:22:07,220 --> 00:22:08,780
También voy a importar el models.

362
00:22:08,870 --> 00:22:11,240
Models Import Order.

363
00:22:13,750 --> 00:22:16,300
Y aquí voy a crear el Class Order Form.

364
00:22:18,390 --> 00:22:20,880
Vamos a poner form a Model Form.

365
00:22:22,350 --> 00:22:23,340
Dos puntos.

366
00:22:24,610 --> 00:22:25,780
Es más un class.

367
00:22:25,810 --> 00:22:32,410
Meta dos puntos y le decimos que el model está basado en la entidad order.

368
00:22:34,140 --> 00:22:39,000
Y vamos a declarar los files, los campos que este va a tener y que tienen que hacer un match con los

369
00:22:39,000 --> 00:22:42,060
campos en el formulario HTML del template.

370
00:22:42,570 --> 00:22:44,910
Comenzamos con Feathers Name.

371
00:22:46,600 --> 00:22:48,610
También vamos a tener al Last Name.

372
00:22:49,720 --> 00:22:51,580
También vamos a tener a Ismael.

373
00:22:52,540 --> 00:22:54,430
También vamos a tener a Andrés.

374
00:22:55,960 --> 00:22:58,840
Aquí va a ser el link WOM con una sola s.

375
00:22:59,680 --> 00:23:01,900
También le vamos a poner el Address.

376
00:23:02,620 --> 00:23:06,100
Me toca el A3 nieto con una S también.

377
00:23:07,180 --> 00:23:09,430
Y ahora le ponemos el country.

378
00:23:10,420 --> 00:23:10,900
Coma.

379
00:23:10,900 --> 00:23:12,820
También le ponemos el state.

380
00:23:13,150 --> 00:23:13,840
Primero le saque.

381
00:23:14,140 --> 00:23:16,750
Luego le pongo el City, la ciudad.

382
00:23:17,200 --> 00:23:19,570
Y ahora le pongo la order not.

383
00:23:20,800 --> 00:23:21,250
Listo.

384
00:23:21,880 --> 00:23:25,600
Vamos a revisar la parte superior a que me faltó agregar una S al Form.

385
00:23:25,900 --> 00:23:27,010
Debería ser Forms.

386
00:23:28,620 --> 00:23:30,760
Y aquí la propiedad debería ser Fields.

387
00:23:30,810 --> 00:23:32,190
Con ese al final también.

388
00:23:32,850 --> 00:23:37,560
Antes del email, vamos a colocarle también la propiedad para que lea el número de teléfono.

389
00:23:37,560 --> 00:23:39,750
Por eso le pongo font y le pongo su coma.

390
00:23:39,840 --> 00:23:46,840
Vamos a regresar un momento al archivo del CP y ya que mira dentro de la entidad order primeramente

391
00:23:46,860 --> 00:23:49,870
que ya sabes que esta con una sola S, address y address.

392
00:23:50,790 --> 00:23:57,090
Pero aquí en esta función de STR estoy indicándole que me devuelva el name desde el user.

393
00:23:57,300 --> 00:23:58,150
Voy a cambiar esto.

394
00:23:58,150 --> 00:24:04,200
Yo quiero que me devuelva el first name desde el self, porque ese first name ya lo tengo como un atributo

395
00:24:04,200 --> 00:24:04,860
principal.

396
00:24:06,560 --> 00:24:09,260
Ahora vamos a volver un momento al punto Pi y.

397
00:24:10,330 --> 00:24:12,310
Aquí dentro del placeholder.

398
00:24:12,730 --> 00:24:18,310
Vamos a ver la función aquí tiene una condición de card count menor o igual que cero.

399
00:24:18,670 --> 00:24:20,350
Aquí me faltó agregar los dos puntos.

400
00:24:20,860 --> 00:24:22,210
Vamos a bajar un poco.

401
00:24:22,210 --> 00:24:29,380
Y aquí, dentro de estas líneas de los campos de seteo de Address Adeslas, voy a indicarle que sea

402
00:24:29,380 --> 00:24:31,090
también como padres con una s.

403
00:24:31,630 --> 00:24:39,970
Una vez hecho estos cambios, ya podemos ir entonces hacia el template para indicarle que ejecute esta

404
00:24:39,970 --> 00:24:41,200
función Plesk Order.

405
00:24:41,770 --> 00:24:43,720
Entonces vamos a ir a Templates.

406
00:24:44,230 --> 00:24:45,940
Aquí está Store.

407
00:24:46,090 --> 00:24:53,890
Dentro de Store aparece checkout punto HTML y aquí tengo la función el formulario action method en post.

408
00:24:55,240 --> 00:24:58,180
Dentro de este action, vamos a agregar.

409
00:24:59,540 --> 00:25:04,730
Que ejecute la URL que sería Place Order.

410
00:25:05,770 --> 00:25:06,340
Perfecto.

411
00:25:06,580 --> 00:25:07,960
Y ahora vamos a la parte inferior.

412
00:25:07,990 --> 00:25:08,380
Un momento.

413
00:25:08,410 --> 00:25:11,470
Quiero ir a los campos que representan la dirección.

414
00:25:12,160 --> 00:25:15,010
Este primero es la dirección y este es el detalle.

415
00:25:15,010 --> 00:25:15,580
Dirección?

416
00:25:16,120 --> 00:25:18,710
Recuerda que le había puesto con una sola ese ladres?

417
00:25:18,820 --> 00:25:18,990
Sí.

418
00:25:19,060 --> 00:25:20,080
Vamos a mantenerlo así.

419
00:25:21,310 --> 00:25:24,340
Guardamos los cambios y vamos a probar.

420
00:25:25,550 --> 00:25:27,770
Estoy logueado en la página de checkout.

421
00:25:27,830 --> 00:25:29,450
Voy a refrescar la página.

422
00:25:29,870 --> 00:25:30,440
Perfecto.

423
00:25:30,440 --> 00:25:31,790
Voy a llenar este formulario.

424
00:25:32,300 --> 00:25:33,680
Ya he llenado el formulario.

425
00:25:33,980 --> 00:25:34,940
Lo tenemos listo.

426
00:25:34,940 --> 00:25:36,650
Le vamos a dar clic al botón.

427
00:25:36,680 --> 00:25:38,180
Ordenar los productos.

428
00:25:38,930 --> 00:25:39,830
Perfecto.

429
00:25:39,840 --> 00:25:41,210
Ya ordené los productos.

430
00:25:41,450 --> 00:25:43,340
Vamos a ir al Change Administration.

431
00:25:44,210 --> 00:25:46,100
Estamos en el local 8000 admin.

432
00:25:46,520 --> 00:25:50,390
Aquí me aparecen todas las entidades y me aparece la entidad de Order.

433
00:25:50,570 --> 00:25:51,260
Vamos a darle clic.

434
00:25:53,330 --> 00:25:56,420
Y me aparece el usuario que es Banksy a nombre de Banksy.

435
00:25:56,420 --> 00:25:59,660
Es que esta es la primera orden que acabo de registrar en la base de datos.

436
00:25:59,990 --> 00:26:07,040
Dale click para ver el detalle y como puedes ver, ya me aparece la información de mi primera orden

437
00:26:07,040 --> 00:26:07,880
de compra.

438
00:26:08,540 --> 00:26:14,090
Ya tengo aquí que el usuario que hizo esta transacción es Banksy red social gmail.com.

439
00:26:15,200 --> 00:26:21,530
También me aparece el número de orden, me aparece el nombre de la persona y el número de teléfono del

440
00:26:21,530 --> 00:26:28,550
estado, la dirección, el total, el taxi y el estatus y el IP desde el cual estoy realizando esta

441
00:26:28,550 --> 00:26:32,870
transacción que por ahora, como el local es el 127 001.

442
00:26:33,760 --> 00:26:35,650
Continuamos en el siguiente capítulo.
